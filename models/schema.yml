version: 2
  
sources: 
  - name: raw
    schema: gz_raw_data 
    description:   Raw dataset containing transactional, product, and shipping data for Greenweez.
      Used to calculate financial metrics such as daily sales, margins, and operational costs.
    tables:

    - name: sales
      identifier: raw_gz_sales  
      description: sales of Greenweez / we have on row per product_id found in each orders_id
      loaded_at_field: CAST(date_date AS TIMESTAMP)
      freshness:
          warn_after: {count: 90, period: day}
      tests:
          - unique:
              column_name: "(orders_id || '-' || pdt_id)"
      columns: 
        - name: date_date
          description: date of purchase
        - name: orders_id
          description: foreign key to ship from sales
        - name: pdt_id
          description: foreign key to product from sales
          tests:
          - not_null
        - name: revenue
          description: Revenue generated by the product in this order line.
        - name: quantity
          description: Quantity of products in a particular order
      
      
    - name: product
      identifier: raw_gz_product 
      description: products of greenweez/ products_id is the primary key 
      columns:
        - name: products_id
          description: Unique identifier for the product (joins with sales table). Is the Primary Key for this table.
        - name: purchse_price
          description: Purchase price (cost) of the product for Greenweez.
          tests:
            - not_null
      

    - name: ship 
      identifier: raw_gz_ship
      description: Shipping and logistics data per order, including fees charged to customers
          and internal costs incurred by Greenweez.
      columns: 
        - name: orders_id
          description: Unique identifier for the order (joins with sales table)- Is the Primary Key of this table.
          tests:
            - not_null
            - unique
        - name: shipping_fee
          description: Shipping fee charged to the customer.
        - name: log_cost
          description: Logistics cost incurred by Greenweez (carrier cost).
        - name: ship_cost
          description: Internal shipping cost for Greenweez operations.
    

    - name: bing
      identifier: raw_gz_bing
      description: This table contains raw performance data from Bing Ads campaigns
      tests:
          - unique:
              column_name: "(date_date || '-' || campaign_key)"
      columns: 
        - name: date_date 
          tests:
            - not_null
        - name: paid_source         
        - name: campaign_key
          tests:
            - not_null
        - name: camPGN_name          
        - name: ads_cost         
        - name: impression         
        - name: click
           

    - name: criteo
      identifier: raw_gz_criteo
      description: This table contains raw performance data from Criteo Ads campaigns
      tests:
          - unique:
              column_name: "(date_date || '-' || campaign_key)"
      columns: 
        - name: date_date 
          tests:
            - not_null
        - name: paid_source       
        - name: campaign_key 
          tests:
            - not_null
        - name: camPGN_name          
        - name: ads_cost        
        - name: impression         
        - name: click


    - name: facebook
      identifier: raw_gz_facebook
      description: This table contains raw performance data from Facebook Ads campaigns
      tests:
          - unique:
              column_name: "(date_date || '-' || campaign_key)"
      columns: 
        - name: date_date
          tests:
            - not_null
        - name: paid_source         
        - name: campaign_key
          tests:
            - not_null
        - name: camPGN_name           
        - name: ads_cost          
        - name: impression         
        - name: click
           

    - name: adwords
      identifier: raw_gz_adwords
      description: This table contains raw performance data from Adwords Ads campaigns
      tests:
          - unique:
              column_name: "(date_date || '-' || campaign_key)"
      columns: 
        - name: date_date
          tests:
            - not_null
        - name: paid_source         
        - name: campaign_key  
          tests:
            - not_null
        - name: camPGN_name           
        - name: ads_cost         
        - name: impression
        - name: click
          
       